#Trees constructed with FFP software version 2.0 and Phylip 
#Obtain FFP software from: http://sourceforge.net/projects/ffp-phylogeny/
#
#Gregory E. Sims, Phd
#Contact gesims@lbl.gov or gsims@jcvi.org 
#

These examples are from:

Sims GE and Kim SH (2011)  Whole-genome phylogeny of Escherichia
coli/Shigella group by feature frequency profiles (FFPs). PNAS, 108,
8329-34.

# Constructed from L=24 features and Jensen Shannon Divergence
Figure_1a_tree       # Tree using all features from L=24
Figure_1a_consensus  # 10% Jackknife consensus tree using above tree and
                     # 100 pseudoreplicates

Figure_1b_tree       # Tree using all commonly shared features with frequency
		     # Less than or equal to 3.
Figure_1b_consensus  # Consensus from 10% jacknife of above features

#

You can effectively regenerate the trees by following the steps below.
You will need to obtain a copy of (Phylip http://evolution.genetics.washington.edu/phylip.html)
or substitute another tree generation program which accepts input similar
to Phylip.

1. To download the genomes, use examples/GetEcoliGenomes 

./GetEcoliGenomes

You should now have 39 subdirectories containing genomes in FASTA format.
Plasmids associated with each genome are placed in a subdirectory, 'plasmid'

2. To produce a  standard FFP tree as in Figure 1a. Assuming you are in
the directory below the genome subdirectories

ffpry -l 24 */*.fna | ffpcol | ffprwn | ffpjsd -p taxa_names.txt > infile

3. Use the Phylip utility neighbor to produce a neighbor joining tree.

rm -f outtree
rm -f outfile

neighbor <<EOF
y
EOF

4. You can get a quick view of the tree produced from the 'outfile'
generated by neighbor.  The Newick style tree file 'outtree' can be
viewed in a number of tree viewers.

5. To generate a consensus tree, using the Phylip utility consense. 

ffpry -l 24 */*.fna | ffpcol > ffpjack.in

for i in {1..100} ; do
	ffpboot -j -p 0.1 ffpjack.in | ffprwn | ffpjsd -p taxa_names.txt
done > infile

#Infile will contain multiple distance matrices which can be processed
#in batch form by neighbor using the 'm' menu option

rm -f outtree
rm -f outfile

neighbor <<EOF
m
y
EOF

mv outtree intree

consense <<EOF
EOF

6.  To generate tree 1b, using feature filtering and the Evolutionary distance: 

ffpry -l 24 */*.fna | ffpfilt -l 1 -u 3 |  ffpcol | ffpjsd -L -p taxa_names.txt > infile

Use neighbor as in 3.


7.  To generate tree 1b in jacknife consensus form:


ffpry -l 24 */*.fna | ffpfilt -l 1 -u 3 |  ffpcol > ffpjack.in

for i in {1..100} ; do
	ffpjsd -H -p taxa_names.txt
done > infile


Repeat neighbor and consense steps as in step 5.
